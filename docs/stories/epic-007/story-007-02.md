# Story 007-02: Save project to native format

**Epic:** EPIC-007 - File Operations and Interoperability
**Status:** Completed
**Estimate:** 8 points
**Assigned To:** Claude

---

## Description

As a pattern designer, I want to save my project to a file so that I can preserve my work and continue later.

---

## Acceptance Criteria

- [ ] User can save via File â†’ Save (Ctrl+S)
- [ ] User can Save As to create new file (Ctrl+Shift+S)
- [ ] All project data is saved: geometry, parameters, constraints, layers, settings
- [ ] File save is atomic (write to temp file, then rename)
- [ ] Save operation completes in < 1 second for typical project (< 5MB)
- [ ] Failed saves don't corrupt existing file
- [ ] Save dialog remembers last used directory
- [ ] File path is stored as "current file" for future saves

---

## Technical Notes

### Implementation Details

- Implement NativeFormat::exportFile()
- Serialize Project to QJsonObject
- Write JSON to file atomically (temp + rename)
- Handle file I/O errors gracefully
- Update window title with filename
- Mark project as "saved" (no unsaved changes)

### Architecture

The save functionality should:
1. Serialize the entire project state to a QJsonObject
2. Write to a temporary file first
3. If successful, atomically rename to target filename
4. Update application state (window title, current file path, saved flag)

### Error Handling

- Catch and handle file I/O exceptions
- Display clear error messages to user
- Never corrupt existing file if save fails
- Log errors for debugging

---

## Dependencies

- story-007-01 (Design and implement native JSON file format)

---

## Definition of Done

- [ ] Code implemented and follows project coding standards
- [ ] Unit tests written and passing
- [ ] Integration tests verify save functionality
- [ ] Manual testing completed on Linux and Windows
- [ ] Save dialog remembers last directory
- [ ] Atomic save prevents file corruption
- [ ] Documentation updated (user guide and API docs)
- [ ] Code reviewed and approved
- [ ] Performance verified (< 1 second for typical projects)
- [ ] Error handling tested (disk full, permission denied, etc.)
