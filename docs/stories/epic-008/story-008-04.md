# Story 008-04: Create properties panel

**Epic:** EPIC-008 - User Interface and Cross-Platform Foundation
**Status:** Not Started
**Estimate:** 5 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want a properties panel that shows selected object properties
so that I can view and edit object attributes.

---

## Acceptance Criteria

- [ ] Properties panel is dockable widget on right side
- [ ] Panel shows properties of selected object(s)
- [ ] Properties include: Position (X, Y), Size (W, H), Rotation, Line weight, Color
- [ ] Properties organized into collapsible sections
- [ ] Numeric properties have input fields with unit notation
- [ ] Properties update dynamically when selection changes
- [ ] Multi-selection shows common properties or "Mixed" indicator
- [ ] Panel can be hidden/shown (View menu)

---

## Technical Notes

**Implementation Details:**
- Implement PropertiesPanel (QDockWidget)
- Use QFormLayout for property editors
- Connect to selection changes
- Update property widgets when selection changes
- Handle multi-selection display

**Key Components:**
```cpp
class PropertiesPanel : public QDockWidget {
    Q_OBJECT
public:
    explicit PropertiesPanel(QWidget *parent = nullptr);

    void setSelectedObjects(const QList<GeometryObject*>& objects);
    void clear();

signals:
    void propertyChanged(const QString& property, const QVariant& value);

private slots:
    void onSelectionChanged();
    void onPropertyEdited();

private:
    void createUI();
    void updateProperties();
    void showCommonProperties(const QList<GeometryObject*>& objects);

    QScrollArea* scrollArea_;
    QWidget* contentWidget_;

    // Property editors
    QDoubleSpinBox* xPosEdit_;
    QDoubleSpinBox* yPosEdit_;
    QDoubleSpinBox* widthEdit_;
    QDoubleSpinBox* heightEdit_;
    QDoubleSpinBox* rotationEdit_;
    QDoubleSpinBox* lineWeightEdit_;
    QPushButton* colorButton_;
    QComboBox* lineStyleCombo_;

    QList<GeometryObject*> selectedObjects_;
};
```

**Property Sections:**

1. **Transform Properties:**
   - X Position: Double spin box with unit label (mm/cm/inches)
   - Y Position: Double spin box with unit label
   - Width: Double spin box (if applicable)
   - Height: Double spin box (if applicable)
   - Rotation: Double spin box (0-360 degrees)

2. **Appearance Properties:**
   - Line Weight: Double spin box (0.1mm - 5.0mm)
   - Line Color: Color picker button
   - Line Style: Combo box (Solid, Dashed, Dotted)
   - Fill Color: Color picker button (if applicable)

3. **Object-Specific Properties:**
   - Circle: Radius
   - Rectangle: Corner radius
   - Bezier: Control point coordinates

**Property Editor Widgets:**
```cpp
// Position editor with unit support
class UnitDoubleSpinBox : public QDoubleSpinBox {
public:
    void setUnit(Unit unit);
    double valueInBaseUnit() const;
    void setValueInBaseUnit(double value);

private:
    Unit currentUnit_;
};

// Color picker button
class ColorButton : public QPushButton {
    Q_OBJECT
public:
    void setColor(const QColor& color);
    QColor getColor() const;

signals:
    void colorChanged(const QColor& color);

private slots:
    void pickColor();

private:
    QColor currentColor_;
};
```

**Multi-Selection Handling:**
- If all objects have same property value: Show the value
- If objects have different values: Show "Mixed" placeholder
- Editing a "Mixed" property: Apply to all selected objects
- Disable properties that don't apply to all selected object types

**Collapsible Sections:**
- Use QGroupBox with custom style for collapse/expand
- Save section collapse state in QSettings
- Sections: "Transform", "Appearance", "Geometry"

---

## Dependencies

- story-008-01 (Main window must exist)

---

## Definition of Done

- [ ] Code implemented and committed
- [ ] Unit tests written and passing
- [ ] Integration tests passing
- [ ] Code reviewed and approved
- [ ] Documentation updated
- [ ] Manual testing completed
- [ ] No critical or high-priority bugs
- [ ] Acceptance criteria verified
- [ ] Multi-selection behavior tested
- [ ] Panel state persists across sessions
