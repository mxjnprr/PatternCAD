# Story 006-01: Measure distances between points and along paths

**Epic:** EPIC-006 - Measurement and Dimensioning
**Status:** Not Started
**Estimate:** 5 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to measure distances between points and along curves
so that I can verify pattern dimensions are correct.

---

## Acceptance Criteria

- [ ] User can select Measure tool (D key)
- [ ] User clicks two points to measure straight-line distance
- [ ] User can measure distance along polyline or curve (total path length)
- [ ] Measurement displays in current unit system (mm, cm, inches)
- [ ] Measurement shows live preview while moving cursor
- [ ] Measurements can be saved as temporary or persistent annotations
- [ ] User can clear all measurements or individual measurements

---

## Technical Notes

**MeasureTool:**
```cpp
class MeasureTool : public Tool {
    Point2D startPoint;
    Point2D currentPoint;
    bool measuring = false;

    void onMousePress(MouseEvent& event) override {
        startPoint = event.position;
        measuring = true;
    }

    void onMouseMove(MouseEvent& event) override {
        if (measuring) {
            currentPoint = event.position;

            // Update live preview
            double distance = startPoint.distanceTo(currentPoint);
            showPreview(startPoint, currentPoint, distance);
        }
    }

    void onMouseRelease(MouseEvent& event) override {
        currentPoint = event.position;
        double distance = startPoint.distanceTo(currentPoint);

        // Create measurement annotation
        Measurement* m = new Measurement(startPoint, currentPoint, distance);
        project->addMeasurement(m);

        measuring = false;
    }
};
```

**Measurement Class:**
```cpp
class Measurement {
    Point2D point1;
    Point2D point2;
    double value;  // in project units
    QString label;
    bool persistent;  // vs. temporary

    QString getDisplayValue() const {
        Unit unit = project->getUnit();
        return formatDistance(value, unit);
    }

    void render(QPainter& painter) {
        // Draw measurement line
        painter.setPen(QPen(Qt::blue, 1, Qt::DashDotLine));
        painter.drawLine(point1, point2);

        // Draw endpoints
        painter.setBrush(Qt::blue);
        painter.drawEllipse(point1, 3, 3);
        painter.drawEllipse(point2, 3, 3);

        // Draw distance label at midpoint
        Point2D midpoint = (point1 + point2) / 2.0;
        QFont font;
        font.setPointSize(10);
        painter.setFont(font);
        painter.drawText(midpoint, getDisplayValue());
    }
};
```

**Path Length Measurement:**
```cpp
double measurePathLength(const std::vector<GeometryObject*>& path) {
    double totalLength = 0.0;

    for (GeometryObject* obj : path) {
        if (Line* line = dynamic_cast<Line*>(obj)) {
            totalLength += line->length();
        } else if (CubicBezier* curve = dynamic_cast<CubicBezier*>(obj)) {
            totalLength += curve->arcLength();  // Numerical integration
        }
    }

    return totalLength;
}
```

**Measurements Panel:**
- List all measurements in project
- Show: point coordinates, distance value
- Allow deleting individual measurements
- "Clear All Measurements" button

---

## Dependencies

None (standalone tool)

---

## Definition of Done

- [ ] MeasureTool implemented
- [ ] Straight-line distance measurement working
- [ ] Path length measurement working
- [ ] Live preview showing
- [ ] Unit conversion working
- [ ] Persistent measurements (annotations)
- [ ] Measurements panel UI
- [ ] Clear measurements working
- [ ] Unit tests for distance calculations
- [ ] Integration tests
- [ ] Documentation updated
- [ ] Merged to main branch
