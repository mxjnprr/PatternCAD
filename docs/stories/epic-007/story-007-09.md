# Story 007-09: Export to SVG format

**Epic:** EPIC-007 - File Operations and Interoperability
**Status:** Not Started
**Estimate:** 8 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to export patterns to SVG format so that I can use them in vector graphics tools or web applications.

---

## Acceptance Criteria

- [ ] User can export to SVG via File → Export → SVG
- [ ] Export to SVG 1.1 format
- [ ] Exported elements: path, line, circle, ellipse as appropriate
- [ ] Export includes proper viewBox and dimensions for accurate scaling
- [ ] User can specify SVG units: px, mm, cm, inches
- [ ] Layers exported as SVG groups with IDs
- [ ] Export preserves stroke width, colors, fill properties
- [ ] Bezier curves exported as SVG cubic bezier commands
- [ ] Export produces clean, readable SVG (formatted, not minified)
- [ ] Export tested with Inkscape, Illustrator, web browsers

---

## Technical Notes

### Implementation Details

- Use Qt SVG or custom SVG writer
- Map PatternCAD geometry to SVG elements
- Set viewBox correctly
- Export layers as groups
- Preserve styles
- Format output for readability

### Geometry Mapping

| PatternCAD Geometry | SVG Element |
|---------------------|-------------|
| Line | `<line>` |
| Circle | `<circle>` |
| Ellipse | `<ellipse>` |
| Rectangle | `<rect>` |
| Polyline | `<polyline>` |
| Polygon | `<polygon>` |
| CubicBezier | `<path>` with C commands |
| Complex shapes | `<path>` with multiple commands |

### SVG Structure

The exported SVG should have:
```xml
<svg xmlns="http://www.w3.org/2000/svg"
     width="..." height="..."
     viewBox="0 0 ... ...">
  <g id="layer1" name="...">
    <!-- geometry elements -->
  </g>
  <g id="layer2" name="...">
    <!-- geometry elements -->
  </g>
</svg>
```

### Path Generation

For complex shapes and bezier curves:
- Use M (moveto) for start point
- Use L (lineto) for straight segments
- Use C (cubic bezier) for curves
- Use Z (closepath) for closed shapes

### Style Export

Export relevant styles:
- `stroke` for line color
- `stroke-width` for line weight
- `fill` for fill color (or "none")
- `stroke-linecap` and `stroke-linejoin` for line endings

### Units and ViewBox

- Set viewBox to match pattern dimensions
- Set width/height with user-specified units
- Ensure proper scaling between viewBox and dimensions

### Formatting

- Use indentation for readability
- Add newlines between elements
- Include comments for layers
- Pretty-print XML

---

## Dependencies

None

---

## Definition of Done

- [ ] Code implemented and follows project coding standards
- [ ] Unit tests written and passing for SVG generation
- [ ] Integration tests verify export with sample projects
- [ ] Manual testing completed on Linux and Windows
- [ ] Exported files tested in Inkscape, Illustrator, Chrome, Firefox
- [ ] All geometry types export correctly
- [ ] ViewBox and units set correctly
- [ ] Layer structure preserved as groups
- [ ] Styles exported accurately
- [ ] Bezier curves export as proper path commands
- [ ] Output is readable and well-formatted
- [ ] Documentation updated (user guide, export formats)
- [ ] Code reviewed and approved
- [ ] Compatibility verified with target applications
