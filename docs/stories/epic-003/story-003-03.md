# Story 003-03: Scale objects uniformly and non-uniformly

**Epic:** EPIC-003 - Transformation and Manipulation Tools
**Status:** Not Started
**Estimate:** 5 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to scale pattern pieces by percentage or absolute dimensions
so that I can resize patterns while maintaining or adjusting proportions.

---

## Acceptance Criteria

- [ ] User can scale objects by percentage (e.g., 150%)
- [ ] User can scale uniformly (maintaining proportions)
- [ ] User can scale non-uniformly (different X and Y scale factors)
- [ ] User can define scale origin point (default: selection center)
- [ ] Scale shows preview before committing
- [ ] Parametric relationships are maintained after scaling
- [ ] Scale is undoable

---

## Technical Notes

**ScaleTool Implementation:**
```cpp
class ScaleTool : public Tool {
    Point2D scaleOrigin;
    double scaleX, scaleY;
    bool uniformScale;

    void onMouseDrag(MouseEvent& event) override {
        // Calculate scale factors based on mouse position
        Point2D currentPos = event.position;
        double distance = (currentPos - scaleOrigin).length();
        double initialDistance = (dragStartPos - scaleOrigin).length();

        scaleX = scaleY = distance / initialDistance;

        if (!uniformScale && event.shiftPressed) {
            // Non-uniform scaling
            scaleX = (currentPos.x - scaleOrigin.x) /
                     (dragStartPos.x - scaleOrigin.x);
            scaleY = (currentPos.y - scaleOrigin.y) /
                     (dragStartPos.y - scaleOrigin.y);
        }

        // Show preview
        updatePreview();
    }
};

class ScaleObjectsCommand : public Command {
    std::vector<GeometryObject*> objects;
    Point2D origin;
    double scaleX, scaleY;

    void execute() override {
        QTransform scaleMatrix;
        scaleMatrix.translate(origin.x, origin.y);
        scaleMatrix.scale(scaleX, scaleY);
        scaleMatrix.translate(-origin.x, -origin.y);

        for (auto* obj : objects) {
            obj->applyTransform(scaleMatrix);

            // Update parametric values proportionally
            if (obj->hasParameters()) {
                obj->scaleParameters(scaleX, scaleY);
            }
        }
    }
};
```

**Scale Origin Selection:**
- Default: Center of selection bounding box
- Custom: User clicks point to define scale origin
- Corner handles: Scale from opposite corner

**Parametric Preservation:**
- Scale parametric dimension values proportionally
- If object has "width = 50cm", after 150% scale: "width = 75cm"
- Maintain constraint relationships

**UI/UX:**
- Show scale handles (8 corner and edge handles)
- Corner handles: uniform scale
- Edge handles: non-uniform scale along that axis
- Shift: constrain to uniform scaling
- Alt: scale from center

---

## Dependencies

- story-001-03: Object selection

---

## Definition of Done

- [ ] ScaleTool implemented
- [ ] Uniform scaling working
- [ ] Non-uniform scaling working
- [ ] Scale origin customizable
- [ ] Preview working
- [ ] Parametric values updated correctly
- [ ] Undo/redo working
- [ ] Unit tests for scale transformations
- [ ] Integration tests with UI
- [ ] Documentation updated
- [ ] Merged to main branch
