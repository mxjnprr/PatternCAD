# Story 004-06: Scale entire pattern proportionally

**Epic:** EPIC-004 - Professional Pattern Features
**Status:** Not Started
**Estimate:** 5 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to scale entire pattern by percentage or to fit specific dimensions
so that I can resize patterns while maintaining all parametric relationships.

---

## Acceptance Criteria

- [ ] User can scale pattern by percentage (e.g., 110%)
- [ ] User can scale pattern to fit specific dimensions (e.g., "make width = 50cm")
- [ ] All parametric relationships are maintained after scaling
- [ ] Constraints remain valid after scaling
- [ ] Seam allowances and notches scale appropriately
- [ ] Scale operation is undoable

---

## Technical Notes

**ScalePatternCommand:**
```cpp
class ScalePatternCommand : public Command {
    Pattern* pattern;
    double scaleFactor;

    void execute() override {
        // Scale all parameters by factor
        for (const QString& paramName : pattern->getParameterNames()) {
            double value = pattern->getParameter(paramName);
            pattern->setParameter(paramName, value * scaleFactor);
        }

        // Update geometry via parametric system
        pattern->updateGeometry();

        // Resolve constraints (they should still be valid)
        if (pattern->hasConstraints()) {
            ConstraintSolver solver;
            solver.setConstraints(pattern->getConstraints());
            auto result = solver.solve();

            if (result != ConstraintSolver::Converged) {
                // Scaling broke constraints - warn user
                qWarning() << "Constraints could not be satisfied after scaling";
            }
        }

        // Scale seam allowance widths
        if (pattern->hasSeamAllowance()) {
            SeamAllowance* sa = pattern->getSeamAllowance();
            sa->setWidth(sa->width() * scaleFactor);
        }

        // Scale notch depths
        for (Notch* notch : pattern->getNotches()) {
            notch->setDepth(notch->depth() * scaleFactor);
        }
    }
};
```

**UI - Scale Dialog:**
```
┌─ Scale Pattern ────────────────────────────┐
│ Method:                                     │
│   ○ Scale by percentage                    │
│   ● Scale to fit dimensions                │
│                                             │
│ Current width:  45.0 cm                    │
│ Current height: 60.0 cm                    │
│                                             │
│ Target width:   [50.0] cm                  │
│ Target height:  [66.7] cm (calculated)     │
│                                             │
│ Scale factor: 111.1%                       │
│                                             │
│ [x] Scale seam allowances                  │
│ [x] Scale notches                          │
│                                             │
│ [Scale] [Cancel]                           │
└─────────────────────────────────────────────┘
```

**Scale to Fit:**
- User enters target width or height
- Calculate scale factor: targetWidth / currentWidth
- Apply scale factor to all dimensions
- Other dimension scales proportionally

---

## Dependencies

- story-002-04: Update geometry when parameters change
- story-004-01: Seam allowance (for scaling seam allowance)

---

## Definition of Done

- [ ] ScalePatternCommand implemented
- [ ] Scale by percentage working
- [ ] Scale to fit dimensions working
- [ ] All parametric relationships maintained
- [ ] Constraints remain valid
- [ ] Seam allowances scale correctly
- [ ] Notches scale correctly
- [ ] UI dialog implemented
- [ ] Undo/redo working
- [ ] Unit tests
- [ ] Integration tests
- [ ] Documentation updated
- [ ] Merged to main branch
