# Story 003-05: Distribute objects evenly

**Epic:** EPIC-003 - Transformation and Manipulation Tools
**Status:** Not Started
**Estimate:** 3 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to distribute multiple objects evenly with equal spacing
so that I can create orderly layouts.

---

## Acceptance Criteria

- [ ] User can distribute objects horizontally with equal spacing
- [ ] User can distribute objects vertically with equal spacing
- [ ] User can specify spacing distance
- [ ] Distribution works with 3+ selected objects
- [ ] Distribution is undoable

---

## Technical Notes

**Distribute Command Implementation:**
```cpp
enum DistributeMode {
    DistributeHorizontal,
    DistributeVertical
};

class DistributeObjectsCommand : public Command {
    std::vector<GeometryObject*> objects;
    DistributeMode mode;
    double spacing;  // Optional: fixed spacing. If 0, use equal gaps

    void execute() override {
        if (objects.size() < 3) {
            // Need at least 3 objects to distribute
            return;
        }

        // Sort objects by position
        if (mode == DistributeHorizontal) {
            std::sort(objects.begin(), objects.end(),
                     [](auto* a, auto* b) {
                         return a->boundingRect().center().x() <
                                b->boundingRect().center().x();
                     });
        } else {
            std::sort(objects.begin(), objects.end(),
                     [](auto* a, auto* b) {
                         return a->boundingRect().center().y() <
                                b->boundingRect().center().y();
                     });
        }

        // Keep first and last objects fixed, distribute others evenly
        GeometryObject* first = objects.front();
        GeometryObject* last = objects.back();

        double totalSpan = calculateSpan(first, last);
        double gapSize;

        if (spacing > 0) {
            // Fixed spacing specified
            gapSize = spacing;
        } else {
            // Calculate equal gaps
            double totalObjectSize = calculateTotalObjectSize();
            double availableSpace = totalSpan - totalObjectSize;
            gapSize = availableSpace / (objects.size() - 1);
        }

        // Position objects
        double currentPos = getPosition(first);
        for (size_t i = 1; i < objects.size() - 1; i++) {
            currentPos += getSize(objects[i-1]) + gapSize;
            setPosition(objects[i], currentPos);
        }
    }

    double calculateSpan(GeometryObject* first, GeometryObject* last) {
        if (mode == DistributeHorizontal) {
            return last->boundingRect().center().x() -
                   first->boundingRect().center().x();
        } else {
            return last->boundingRect().center().y() -
                   first->boundingRect().center().y();
        }
    }
};
```

**Distribution Modes:**
1. **Even spacing**: Equal gaps between object centers
2. **Even gaps**: Equal space between object edges

**UI Integration:**
- Add "Distribute" menu with submenu options
- Keyboard shortcuts: Ctrl+Shift+D,H (horizontal), Ctrl+Shift+D,V (vertical)
- Toolbar buttons with distribute icons

**Edge Cases:**
- Less than 3 objects: Show warning message
- Objects overlapping after distribution: Allow it (don't validate)

---

## Dependencies

- story-001-03: Object selection

---

## Definition of Done

- [ ] DistributeObjectsCommand implemented
- [ ] Horizontal distribution working
- [ ] Vertical distribution working
- [ ] Fixed spacing option working
- [ ] UI integration (menu, shortcuts)
- [ ] Undo/redo working
- [ ] Unit tests for distribution calculations
- [ ] Integration tests with UI
- [ ] Documentation updated
- [ ] Merged to main branch
