# Story 002-07: Apply coincident and tangent constraints

**Epic:** EPIC-002 - Parametric Design and Constraint System
**Status:** Not Started
**Estimate:** 5 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to constrain points to be coincident and curves to be tangent
so that pattern pieces connect smoothly.

---

## Acceptance Criteria

- [ ] User can constrain two points to be coincident (at same location)
- [ ] User can constrain curves to be tangent at connection point
- [ ] Coincident points merge visually (shown as single point)
- [ ] Tangent constraints maintain smooth continuity (G1 continuity)
- [ ] Solver enforces constraints during edits
- [ ] Visual indicators show constraint type
- [ ] Constraints saved with project

---

## Technical Notes

**Coincident Constraint:**
```cpp
class CoincidentConstraint : public Constraint {
    Point2D* point1;
    Point2D* point2;

    double evaluate() const override {
        // Points should be at same location (distance = 0)
        return point1->distanceTo(*point2);
    }
};
```

**Tangent Constraint:**
```cpp
class TangentConstraint : public Constraint {
    Curve* curve1;
    Curve* curve2;
    Point2D* connectionPoint;  // Where curves meet

    double evaluate() const override {
        // Tangent vectors at connection point should be collinear
        Vector2D tangent1 = curve1->tangentAt(connectionPoint);
        Vector2D tangent2 = curve2->tangentAt(connectionPoint);

        // Normalize
        tangent1.normalize();
        tangent2.normalize();

        // Cross product should be 0 (vectors parallel)
        double cross = tangent1.cross(tangent2);
        return std::abs(cross);
    }
};
```

**Visual Indicators:**
- Coincident: Draw small circle or cross at merged point
- Tangent: Draw smooth connection indicator (small "S" curve icon)
- Highlight both curves when constraint selected

**UI Considerations:**
- When creating coincident constraint, snap points together visually
- Show warning if trying to make coincident points that are far apart
- Tangent constraint requires curves to share an endpoint

---

## Dependencies

- story-002-05: Constraint base classes
- story-001-02: Bezier curves (for tangent constraints)

---

## Definition of Done

- [ ] Coincident and tangent constraint classes implemented
- [ ] UI for creating constraints
- [ ] Visual indicators working
- [ ] Constraints integrated with solver
- [ ] Unit tests for both constraint types
- [ ] Documentation updated
- [ ] Merged to main branch
