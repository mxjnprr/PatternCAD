# Story 007-06: Import DXF files

**Epic:** EPIC-007 - File Operations and Interoperability
**Status:** Completed
**Estimate:** 13 points
**Assigned To:** Claude

---

## Description

As a pattern designer, I want to import patterns from DXF files so that I can use patterns created in other CAD tools.

---

## Acceptance Criteria

- [ ] User can import DXF files via File → Import → DXF
- [ ] System supports DXF R12 and later versions (R2018+)
- [ ] Supported entities: LINE, CIRCLE, ARC, POLYLINE, LWPOLYLINE, SPLINE, POINT
- [ ] Import preserves layer information
- [ ] Import handles multiple units: mm, cm, inches (with auto-detection)
- [ ] User can override unit interpretation if needed
- [ ] Import creates new layer(s) named after source file
- [ ] Large DXF files show progress indicator
- [ ] Import errors are reported clearly with entity details

---

## Technical Notes

### Implementation Details

- Use libdxfrw or implement custom DXF R12 parser
- Map DXF entities to PatternCAD geometry
- Handle unit conversion
- Create layers from DXF layers
- Show progress dialog for large files
- Handle parse errors gracefully
- Implement DXFFormat class

### DXF Entity Mapping

| DXF Entity | PatternCAD Geometry |
|------------|---------------------|
| LINE | Line |
| CIRCLE | Circle |
| ARC | Arc |
| POLYLINE | Polyline/Polygon |
| LWPOLYLINE | Polyline/Polygon |
| SPLINE | CubicBezier (converted) |
| POINT | Point |

### Unit Detection

- Check DXF header variable $INSUNITS
- Common values: 1=inches, 4=mm, 5=cm
- If not set, allow user to specify
- Apply conversion factor to all coordinates

### Layer Handling

- Parse TABLES section for layer definitions
- Create corresponding layers in PatternCAD
- Preserve layer names, colors (if applicable)
- Assign imported entities to correct layers

### Error Handling

- Handle malformed DXF files gracefully
- Report unsupported entities with warning
- Log parse errors with line numbers
- Allow partial import (skip bad entities)

---

## Dependencies

None

---

## Definition of Done

- [ ] Code implemented and follows project coding standards
- [ ] Unit tests written and passing for DXF parsing
- [ ] Integration tests verify import with sample DXF files
- [ ] Manual testing completed on Linux and Windows
- [ ] Tested with DXF files from AutoCAD, QCAD, LibreCAD
- [ ] All supported entities import correctly
- [ ] Unit conversion works accurately
- [ ] Layer import preserves structure
- [ ] Progress indicator works for large files
- [ ] Error handling tested with malformed files
- [ ] Documentation updated (user guide, supported formats)
- [ ] Code reviewed and approved
- [ ] Performance verified (reasonable import times)
