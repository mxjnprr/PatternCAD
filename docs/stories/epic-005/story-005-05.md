# Story 005-05: Isolation mode for working with subset of pieces

**Epic:** EPIC-005 - Layout, Nesting, and Isolation
**Status:** Not Started
**Estimate:** 8 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to isolate selected pieces to work on them without visual clutter
so that I can focus on specific pieces in projects with hundreds of pieces.

---

## Acceptance Criteria

- [ ] User selects pieces and presses Tab to enter isolation mode
- [ ] Only selected pieces remain visible on canvas
- [ ] All other pieces are hidden (not deleted)
- [ ] Visual indicator shows isolation mode is active (status bar message, border color)
- [ ] Status bar shows "Isolation: N pieces"
- [ ] User can edit isolated pieces normally (all tools work)
- [ ] User presses Shift+Tab to exit isolation mode
- [ ] All pieces become visible again
- [ ] Isolation mode toggle is instant (< 100ms)
- [ ] Canvas rendering is fast in isolation mode (only isolated pieces rendered)

---

## Technical Notes

**IsolationManager:**
```cpp
class IsolationManager {
    std::vector<Pattern*> isolatedPatterns;
    std::vector<Pattern*> hiddenPatterns;
    bool active = false;

public:
    void enterIsolationMode(const std::vector<Pattern*>& selected) {
        if (selected.empty()) return;

        active = true;
        isolatedPatterns = selected;

        // Hide all other patterns
        for (Pattern* pattern : project->getAllPatterns()) {
            if (std::find(selected.begin(), selected.end(), pattern) == selected.end()) {
                pattern->setVisible(false);
                hiddenPatterns.push_back(pattern);
            }
        }

        // Update UI
        emit isolationModeChanged(true, isolatedPatterns.size());

        // Zoom to fit isolated patterns
        view->fitToPatterns(isolatedPatterns);
    }

    void exitIsolationMode() {
        if (!active) return;

        // Restore visibility of all patterns
        for (Pattern* pattern : hiddenPatterns) {
            pattern->setVisible(true);
        }

        active = false;
        isolatedPatterns.clear();
        hiddenPatterns.clear();

        emit isolationModeChanged(false, 0);
    }

    bool isActive() const {
        return active;
    }
};
```

**Visual Indicators:**
```cpp
class CanvasView : public QGraphicsView {
    IsolationManager* isolationManager;

    void paintEvent(QPaintEvent* event) override {
        QGraphicsView::paintEvent(event);

        // Draw isolation mode indicator
        if (isolationManager->isActive()) {
            QPainter painter(viewport());

            // Draw orange border around viewport
            painter.setPen(QPen(QColor(255, 150, 0), 3));
            painter.drawRect(viewport()->rect().adjusted(1, 1, -1, -1));

            // Status bar already shows "Isolation: N pieces"
        }
    }
};
```

**Keyboard Shortcuts:**
- Tab: Enter isolation mode (with selected pieces)
- Shift+Tab: Exit isolation mode

**Performance Optimization:**
- QGraphicsScene only renders visible items
- Isolation mode improves rendering performance by hiding most items
- Target: < 100ms to enter/exit isolation mode

**Edge Cases:**
- If no pieces selected, Tab does nothing (or shows message)
- If already in isolation mode, Tab does nothing
- Shift+Tab outside isolation mode does nothing
- Saving/loading project preserves isolation state (optional)

---

## Dependencies

None (independent feature)

---

## Definition of Done

- [ ] IsolationManager implemented
- [ ] Enter isolation mode (Tab) working
- [ ] Exit isolation mode (Shift+Tab) working
- [ ] Visual indicators (border, status bar message)
- [ ] Only isolated pieces visible
- [ ] All tools work normally in isolation mode
- [ ] Performance target met (< 100ms toggle)
- [ ] Rendering optimization working
- [ ] Unit tests
- [ ] Integration tests
- [ ] Documentation updated
- [ ] Merged to main branch
