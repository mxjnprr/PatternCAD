# Story 002-06: Apply angle constraints (parallel, perpendicular, fixed angle)

**Epic:** EPIC-002 - Parametric Design and Constraint System
**Status:** Not Started
**Estimate:** 5 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to constrain angles between lines
so that lines remain parallel, perpendicular, or at fixed angles.

---

## Acceptance Criteria

- [ ] User can constrain two lines to be parallel
- [ ] User can constrain two lines to be perpendicular
- [ ] User can constrain lines to fixed angle (e.g., 45°)
- [ ] Constraints are visually indicated with symbols (∥, ⊥, angle arc with value)
- [ ] Solver maintains angle constraints when objects moved
- [ ] User can remove or temporarily disable constraints
- [ ] Constraints are saved with project

---

## Technical Notes

**Angle Constraint Classes:**
```cpp
class ParallelConstraint : public Constraint {
    Line* line1;
    Line* line2;

    double evaluate() const override {
        // Parallel if dot product of direction vectors = ±1
        Vector2D dir1 = line1->direction().normalized();
        Vector2D dir2 = line2->direction().normalized();
        double dot = dir1.dot(dir2);
        return std::min(std::abs(dot - 1.0), std::abs(dot + 1.0));
    }
};

class PerpendicularConstraint : public Constraint {
    Line* line1;
    Line* line2;

    double evaluate() const override {
        // Perpendicular if dot product = 0
        Vector2D dir1 = line1->direction().normalized();
        Vector2D dir2 = line2->direction().normalized();
        return std::abs(dir1.dot(dir2));  // Should be 0
    }
};

class FixedAngleConstraint : public Constraint {
    Line* line1;
    Line* line2;
    double targetAngle;  // in radians

    double evaluate() const override {
        double actualAngle = line1->angleTo(*line2);
        double diff = actualAngle - targetAngle;
        // Normalize to [-π, π]
        while (diff > M_PI) diff -= 2*M_PI;
        while (diff < -M_PI) diff += 2*M_PI;
        return diff;
    }
};
```

**Visual Indicators:**
- Parallel: Draw ∥ symbol near lines
- Perpendicular: Draw ⊥ symbol or small square at intersection
- Fixed angle: Draw arc with angle value label

---

## Dependencies

- story-002-05: Constraint base classes
- Line geometry objects

---

## Definition of Done

- [ ] Angle constraint classes implemented
- [ ] UI for creating angle constraints
- [ ] Visual indicators rendered
- [ ] Constraints work with solver
- [ ] Unit tests for angle constraints
- [ ] Documentation updated
- [ ] Merged to main branch
