# Story 003-04: Align objects relative to each other

**Epic:** EPIC-003 - Transformation and Manipulation Tools
**Status:** Not Started
**Estimate:** 3 points
**Assigned To:** Unassigned

---

## Description

As a pattern designer, I want to align multiple objects along edges or centers
so that I can organize pattern pieces neatly.

---

## Acceptance Criteria

- [ ] User can align selected objects: left, right, top, bottom edges
- [ ] User can align centers horizontally or vertically
- [ ] Alignment reference can be selection bounds or a specific object
- [ ] Preview shows alignment result before applying
- [ ] Alignment is undoable
- [ ] Works with 2+ selected objects

---

## Technical Notes

**Align Command Implementation:**
```cpp
enum AlignMode {
    AlignLeft,
    AlignRight,
    AlignTop,
    AlignBottom,
    AlignCenterHorizontal,
    AlignCenterVertical
};

class AlignObjectsCommand : public Command {
    std::vector<GeometryObject*> objects;
    AlignMode mode;
    GeometryObject* referenceObject;  // null = use selection bounds

    void execute() override {
        QRectF referenceBounds = getReferenceBox();

        for (auto* obj : objects) {
            if (obj == referenceObject) continue;  // Don't move reference

            QRectF objBounds = obj->boundingRect();
            QPointF offset;

            switch (mode) {
                case AlignLeft:
                    offset.setX(referenceBounds.left() - objBounds.left());
                    break;
                case AlignRight:
                    offset.setX(referenceBounds.right() - objBounds.right());
                    break;
                case AlignTop:
                    offset.setY(referenceBounds.top() - objBounds.top());
                    break;
                case AlignBottom:
                    offset.setY(referenceBounds.bottom() - objBounds.bottom());
                    break;
                case AlignCenterHorizontal:
                    offset.setX(referenceBounds.center().x() - objBounds.center().x());
                    break;
                case AlignCenterVertical:
                    offset.setY(referenceBounds.center().y() - objBounds.center().y());
                    break;
            }

            obj->translate(offset);
        }
    }

    QRectF getReferenceBox() {
        if (referenceObject) {
            return referenceObject->boundingRect();
        } else {
            // Use combined bounds of all selected objects
            return calculateSelectionBounds(objects);
        }
    }
};
```

**UI Integration:**
- Add "Align" menu with submenu options
- Keyboard shortcuts: Ctrl+Shift+L (left), R (right), T (top), B (bottom), H (horizontal center), V (vertical center)
- Toolbar buttons with align icons
- Right-click context menu for selected objects

**Reference Object Selection:**
- By default: Align to combined selection bounds
- Advanced: Right-click specific object â†’ "Use as Align Reference"
- The reference object doesn't move; others align to it

---

## Dependencies

- story-001-03: Object selection

---

## Definition of Done

- [ ] AlignObjectsCommand implemented
- [ ] All align modes working (6 modes)
- [ ] Reference object selection working
- [ ] UI integration (menu, shortcuts, toolbar)
- [ ] Preview optional (may defer for simplicity)
- [ ] Undo/redo working
- [ ] Unit tests for alignment calculations
- [ ] Integration tests with UI
- [ ] Documentation updated
- [ ] Merged to main branch
